<!-- app01/templates/app01/result.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Task Result</title>
    <script>
        function checkStatus() {
            fetch(window.location.href)
                .then(response => response.text())
                .then(html => {
                    document.body.innerHTML = html;
                    if (!html.includes('Job is still running...')) {
                        clearInterval(statusInterval);
                    }
                })
                .catch(error => console.error('Error fetching job status:', error));
        }

        const statusInterval = setInterval(checkStatus, 5000); // 每5秒检查一次状态
    </script>
</head>
<body>
    <h1>Task Result</h1>
    <pre>{{ result }}</pre>
    {% if image_path %}
        <h2>Generated PDF</h2>
        <a href="{{ image_path }}" target="_blank">Download PDF</a>
        <br>
        <embed src="{{ image_path }}" width="100%" height="500px" type="application/pdf">
    {% endif %}
</body>
</html>